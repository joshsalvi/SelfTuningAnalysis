function [DecayTimes,OscTimes,Xvar] = OscDelayTimes(datapath,index,NForceSteps,NReplicates,PulseStart,PulseEnd,width,window,automateyn)load(sprintf('%s%s',datapath,'Extracted Data.mat'));data = Xd2{1,index};DecayTimes = zeros(NForceSteps,NReplicates);OscTimes = zeros(NForceSteps,NReplicates);MeanThresh = 0.1;VarThresh = 0.5;figure, plot(data)j=0;while j<1    if input('Any slips? Y or N (1=yes) ')==0            j=1;    else        SlipLoc = input('Slip location? ');        right = mean(data(SlipLoc-200:SlipLoc-5));        left = mean(data(SlipLoc+5:SlipLoc+200));        data(SlipLoc+1:length(data))=data(SlipLoc+1:length(data))+(right-left);        plot(data)    endendfor q = 1:NReplicates    for k = 1:NForceSteps        timeseries = data(1+(k-1)*width+(q-1)*NForceSteps*width:k*width+(q-1)*NForceSteps*width);        [DataVar] = LeveledXdFits2(timeseries,window,PulseStart,PulseEnd,automateyn);        StepVar = mean(DataVar(PulseStart+window:PulseEnd));%+ceil((PulseEnd-PulseStart)/2):PulseEnd));        OscTimes(k,q) = find(DataVar(PulseStart+window:length(DataVar)) > VarThresh*StepVar,1)+window;        Xvar{k,q} = DataVar;        InitMean = mean(timeseries(1:PulseStart));        StepMean = mean(timeseries(ceil(PulseStart+(PulseEnd-PulseStart)/2):PulseEnd));        DecayTimes(k,q) = find((timeseries(PulseStart:length(timeseries))-StepMean) < MeanThresh*(InitMean-StepMean),1);                disp('Saving...');        save([datapath 'Ind' num2str(index) '-OscAndDecayTimes.mat'],'OscTimes','DecayTimes','Xvar')        disp('Saved.');        close all    end    end